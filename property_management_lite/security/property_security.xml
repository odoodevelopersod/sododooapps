<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Property Management Security Groups -->
    <record id="module_category_property_management" model="ir.module.category">
        <field name="name">Property Management</field>
        <field name="description">Manage property rental operations</field>
        <field name="sequence">20</field>
    </record>

    <!-- User Groups -->
    <record id="group_property_user" model="res.groups">
        <field name="name">Property User</field>
        <field name="category_id" ref="module_category_property_management"/>
        <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        <field name="comment">Property management users can view and create basic records</field>
    </record>

    <record id="group_property_officer" model="res.groups">
        <field name="name">Property Officer</field>
        <field name="category_id" ref="module_category_property_management"/>
        <field name="implied_ids" eval="[(4, ref('group_property_user'))]"/>
        <field name="comment">Property officers can manage collections, expenses, and tenant operations</field>
    </record>

    <record id="group_property_manager" model="res.groups">
        <field name="name">Property Manager</field>
        <field name="category_id" ref="module_category_property_management"/>
        <field name="implied_ids" eval="[(4, ref('group_property_officer'))]"/>
        <field name="comment">Property managers have full access to property management features</field>
    </record>

    <record id="group_property_admin" model="res.groups">
        <field name="name">Property Administrator</field>
        <field name="category_id" ref="module_category_property_management"/>
        <field name="implied_ids" eval="[(4, ref('group_property_manager'))]"/>
        <field name="comment">Property administrators have complete access including system configuration</field>
    </record>

    <record id="group_property_tenant_manager" model="res.groups">
        <field name="name">Property Tenant Manager</field>
        <field name="category_id" ref="module_category_property_management"/>
        <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>
        <field name="comment">Tenant managers can only create and manage tenants and their related data</field>
    </record>

    <!-- Record Rules -->
    
    <!-- Properties: All users can see all properties -->
    <record id="property_property_rule_all" model="ir.rule">
        <field name="name">Property: All Users</field>
        <field name="model_id" ref="model_property_property"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_user'))]"/>
    </record>

    <!-- Collections: Users can only see their own collections -->
    <record id="property_collection_rule_own" model="ir.rule">
        <field name="name">Collections: Own Collections</field>
        <field name="model_id" ref="model_property_collection"/>
        <field name="domain_force">[('collected_by', '=', user.id)]</field>
        <field name="groups" eval="[(4, ref('group_property_user'))]"/>
    </record>

    <!-- Collections: Officers and above can see all -->
    <record id="property_collection_rule_all" model="ir.rule">
        <field name="name">Collections: All Collections</field>
        <field name="model_id" ref="model_property_collection"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_officer'))]"/>
    </record>

    <!-- Tenants: All property users can access -->
    <record id="property_tenant_rule_all" model="ir.rule">
        <field name="name">Tenants: All Users</field>
        <field name="model_id" ref="model_property_tenant"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_user'))]"/>
    </record>

    <!-- Agreements: All property users can access -->
    <record id="property_agreement_rule_all" model="ir.rule">
        <field name="name">Agreements: All Users</field>
        <field name="model_id" ref="model_property_agreement"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_user'))]"/>
    </record>

    <!-- Occupants: All property users can access -->
    <record id="property_occupant_rule_all" model="ir.rule">
        <field name="name">Occupants: All Users</field>
        <field name="model_id" ref="model_property_occupant"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_user'))]"/>
    </record>

    <!-- Tenant Manager specific rules -->
    <record id="property_tenant_rule_tenant_manager" model="ir.rule">
        <field name="name">Tenants: Tenant Manager Access</field>
        <field name="model_id" ref="model_property_tenant"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_tenant_manager'))]"/>
    </record>

    <record id="property_agreement_rule_tenant_manager" model="ir.rule">
        <field name="name">Agreements: Tenant Manager Access</field>
        <field name="model_id" ref="model_property_agreement"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_tenant_manager'))]"/>
    </record>

    <record id="property_occupant_rule_tenant_manager" model="ir.rule">
        <field name="name">Occupants: Tenant Manager Access</field>
        <field name="model_id" ref="model_property_occupant"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_tenant_manager'))]"/>
    </record>

    <!-- Properties: Read-only for tenant managers -->
    <record id="property_property_rule_tenant_manager" model="ir.rule">
        <field name="name">Property: Tenant Manager Read Only</field>
        <field name="model_id" ref="model_property_property"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_tenant_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Rooms: Read-only for tenant managers -->
    <record id="property_room_rule_tenant_manager" model="ir.rule">
        <field name="name">Rooms: Tenant Manager Read Only</field>
        <field name="model_id" ref="model_property_room"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_tenant_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Flats: Read-only for tenant managers -->
    <record id="property_flat_rule_tenant_manager" model="ir.rule">
        <field name="name">Flats: Tenant Manager Read Only</field>
        <field name="model_id" ref="model_property_flat"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_tenant_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>

    <!-- Collections: Read-only for tenant managers -->
    <record id="property_collection_rule_tenant_manager" model="ir.rule">
        <field name="name">Collections: Tenant Manager Read Only</field>
        <field name="model_id" ref="model_property_collection"/>
        <field name="domain_force">[]</field>
        <field name="groups" eval="[(4, ref('group_property_tenant_manager'))]"/>
        <field name="perm_read" eval="True"/>
        <field name="perm_write" eval="False"/>
        <field name="perm_create" eval="False"/>
        <field name="perm_unlink" eval="False"/>
    </record>
</odoo>
